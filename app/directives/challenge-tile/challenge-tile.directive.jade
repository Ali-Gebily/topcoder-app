.challenge.tile-view(ng-show="view === 'tile'", ng-class="challenge.track")
  .active-challenge(ng-show="challenge.status === 'ACTIVE'")
    .challenge-track

    header
      a(ng-hide="challenge.subTrack === 'MARATHON_MATCH'", ng-href="https://www.{{DOMAIN}}/challenge-details/{{challenge.id}}/?type={{challenge.track}}") {{challenge.name}}

      a(ng-show="challenge.subTrack === 'MARATHON_MATCH'", ng-href="https://community.{{DOMAIN}}/tc?module=MatchDetails&rd={{challenge.rounds[0].id}}") {{challenge.name}}

      p.subtrack-color {{challenge.subTrack | underscoreStrip}}

    .challenge-details
      p.currentPhase {{challenge.userCurrentPhase}}

      .challenge-calendar(ng-show="challenge.userCurrentPhaseEndTime")
        p.ends-in Ends In
        p.time-remaining {{challenge.userCurrentPhaseEndTime[0]}}
        p.unit-of-time {{challenge.userCurrentPhaseEndTime[1]}}

      .stalled-challenge(ng-hide="challenge.userCurrentPhaseEndTime") This challenge is currently paused.

      .phase-action(ng-switch="challenge.userAction")
        a.tc-btn.tc-btn-s.tc-btn-wide.submit(ng-switch-when="Submit") Submit

        .submitted(ng-switch-when="Submitted") Submitted

        // TODO: Need styling and JS logic for this one
        .registered(ng-switch-when="Registered") Registered

      // Only show if not data science track
      p.roles(ng-hide="challenge.track === 'DATA_SCIENCE'") {{challenge.userDetails.roles | listRoles}}

      .challenge-links
        .stats
          a.registrants(ng-hide="challenge.subTrack === 'MARATHON_MATCH'", ng-href="https://www.{{DOMAIN}}/challenge-details/{{challenge.id}}/?type={{challenge.track}}#viewRegistrant")
            .registrants-icon

            p {{challenge.numRegistrants}}

          a.registrants(ng-show="challenge.subTrack === 'MARATHON_MATCH'", ng-href="https://community.{{DOMAIN}}/longcontest/?module=ViewStandings&rd={{challenge.rounds[0].id}}")
            .registrants-icon

            p {{challenge.numRegistrants[0]}}

          a.submissions(ng-hide="challenge.track === 'DATA_SCIENCE'", ng-href="https://www.{{DOMAIN}}/challenge-details/{{challenge.id}}/?type={{challenge.track}}#viewRegistrant")
            .submissions-icon

            p {{challenge.numSubmissions}}

        a.forum(ng-href="http://apps.{{DOMAIN}}/forums//?module=Category&categoryID={{challenge.forumId}}")
          .forum-icon

          p Forum

  .completed-challenge(
    ng-show="challenge.status === 'COMPLETED' || challenge.status === 'PAST'",
    ng-switch="challenge.track")
    header
      // TODO: handle url for past marathon match
      a(ng-href="https://www.{{DOMAIN}}/challenge-details/{{challenge.id}}/?type={{challenge.track}}") {{challenge.name}}

      p.date-completed {{challenge.submissionEndDate | date : 'MMMM yyyy'}}

      .winner-ribbon(ng-show="challenge.wonFirst")

    .challenge-details(ng-switch-when="DATA_SCIENCE", ng-switch="challenge.subTrack", ng-class="challenge.track")

      div(ng-switch-when="MARATHON_MATCH")
        .marathon-score
          p.score {{challenge.pointTotal || 0 }}

          p Total Points

      div(ng-switch-when="SRM")
        p BLAH

    .challenge-details(ng-switch-when="DEVELOP")
      p.place(ng-class="{ 'first-place': challenge.wonFirst }", ng-show="challenge.highestPlacement") {{challenge.highestPlacement}}#[span {{challenge.highestPlacement | ordinal:true}}] Place
      p.place(ng-show="challenge.userStatus === 'NOT_FINISHED'") Didn't Finish
      p.place(ng-show="challenge.userStatus === 'PASSED_SCREENING'") Passed Screening

      .challenge-score(ng-show="challenge.userStatus !== 'NOT_FINISHED'")
        p.score {{challenge.userDetails.submissionReviewScore/100 | percentage}}

        p Review Score

    .challenge-details(ng-switch-when="DESIGN")
      p.place(ng-class="{ 'first-place': challenge.wonFirst }") {{challenge.highestPlacement}}#[span {{challenge.highestPlacement | ordinal:true}}] Place

      .thumbnail(ng-click="openLightbox()")
        img(ng-src="http://studio.{{DOMAIN}}/studio.jpg?module=DownloadSubmission&sbmid={{challenge.thumbnailId}}&sbt=full", fallback-src="/images/ico-picture.svg")

        .thumbnail-gallery(ng-click="challenge.showLightbox()")
          .gallery-icon

          .num-images 1 image

.challenge.list-view(ng-show="view=='list'", ng-class="challenge.track")
  .active-challenge(ng-show="challenge.status === 'ACTIVE'")
    .challenge-track

    header
      a(ng-hide="challenge.subTrack === 'MARATHON_MATCH'", ng-href="https://www.{{DOMAIN}}/challenge-details/{{challenge.id}}/?type={{challenge.track}}") {{challenge.name}}

      a(ng-show="challenge.subTrack === 'MARATHON_MATCH'", ng-href="https://community.{{DOMAIN}}/tc?module=MatchDetails&rd={{challenge.rounds[0].id}}") {{challenge.name}}

      p.subtrack {{challenge.subTrack | underscoreStrip}}

      p.roles(ng-hide="challenge.track === 'DATA_SCIENCE'") #[span Role:] {{challenge.userDetails.roles | listRoles}}

    .challenge-details
      .challenge-info
        p.currentPhase {{challenge.userCurrentPhase}}

        p.ends-in(ng-show="challenge.userCurrentPhaseEndTime") Ends: {{challenge.userCurrentPhaseEndTime[2] | localTime}}

        p.ends-in(ng-hide="challenge.userCurrentPhaseEndTime") This challenge is currently paused.

      .phase-action(ng-switch="challenge.userAction")
        a.tc-btn.tc-btn-s.tc-btn-wide.submit(ng-switch-when="Submit") Submit

        .submitted(ng-switch-when="Submitted") Submitted

        // TODO: Need styling and JS logic for this one
        .registered(ng-switch-when="Registered") Registered

    .challenge-links
      a.registrants(ng-hide="challenge.subTrack === 'MARATHON_MATCH'", ng-href="https://www.{{DOMAIN}}/challenge-details/{{challenge.id}}/?type={{challenge.track}}#viewRegistrant")
        p {{challenge.numRegistrants}}

        .registrants-icon

      a.registrants(ng-show="challenge.subTrack === 'MARATHON_MATCH'", ng-href="https://community.{{DOMAIN}}/longcontest/?module=ViewStandings&rd={{challenge.rounds[0].id}}")
        p {{challenge.numRegistrants[0]}}

        .registrants-icon

      a.submissions(ng-hide="challenge.track === 'DATA_SCIENCE'", ng-href="https://www.{{DOMAIN}}/challenge-details/{{challenge.id}}/?type={{challenge.track}}#viewRegistrant")
        p {{challenge.numSubmissions}}

        .submissions-icon

      a.forum(ng-href="http://apps.{{DOMAIN}}/forums//?module=Category&categoryID={{challenge.forumId}}")
        .forum-icon

        p Forum
  .completed-challenge(
    ng-show="challenge.status === 'COMPLETED' || challenge.status === 'PAST'",
    ng-switch="challenge.track")
    .challenge-track

    header
      a(ng-href="https://www.{{DOMAIN}}/challenge-details/{{challenge.id}}/?type={{challenge.track}}") {{challenge.name}}

      p.subtrack {{challenge.subTrack | underscoreStrip}}

      p.roles(ng-hide="challenge.track === 'DATA_SCIENCE'") #[span Role:] {{challenge.userDetails.roles | listRoles}}

    .challenge-details(ng-switch-when="DATA_SCIENCE", ng-switch="challenge.subTrack", ng-class="challenge.track")

      div(ng-switch-when="MARATHON_MATCH")
        .marathon-score
          p.score {{challenge.pointTotal || 0 }}

          p Total Points

    .challenge-details(ng-switch-when="DEVELOP")
      .place-date
        p.place(ng-class="{ 'first-place': challenge.wonFirst }") {{challenge.highestPlacement}}#[span {{challenge.highestPlacement | ordinal:true}}] Place
        p.date-completed {{challenge.submissionEndDate | date : 'MMMM yyyy'}}

      .winner-ribbon(ng-show="challenge.wonFirst")

      .challenge-score
        p.score {{challenge.userDetails.submissionReviewScore/100 | percentage}}

        p Review Score

    .challenge-details(ng-switch-when="DESIGN")
      .place-date
        p.place(ng-class="{ 'first-place': challenge.wonFirst }") {{challenge.highestPlacement}}#[span {{challenge.highestPlacement | ordinal:true}}] Place
        p.date-completed {{challenge.submissionEndDate | date : 'MMMM yyyy'}}

      .winner-ribbon(ng-show="challenge.wonFirst")

      .thumbnail(ng-click="openLightbox()")
        img(ng-src="http://studio.{{DOMAIN}}/studio.jpg?module=DownloadSubmission&sbmid={{challenge.thumbnailId}}&sbt=full", fallback-src="/images/ico-picture.svg")

        .thumbnail-gallery(ng-click="challenge.showLightbox()")
          .gallery-icon

          .num-images 1 image
